<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Facility Slider with Automation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        /* --- 1. YOUR ORIGINAL LAYOUT CSS --- */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
        }

        .facility {
            display: flex;
            flex-direction: row;
            gap: 40px; /* Increased gap slightly for breathing room */
            margin-top: 40px;
            padding: 40px;
            max-width: 1200px; /* Optional: Constrain max width */
            margin-left: auto;
            margin-right: auto;
        }

        .facility-details {
            width: 50%;
            display: flex;
            flex-direction: column;
            justify-content: center; /* Centers text vertically */
        }

        /* --- Slider Container --- */
        .image-slider {
            position: relative; /* Added for absolute positioning of children */
            display: flex;
            flex-flow: column;
            width: 50%;
            aspect-ratio: 16/9;
            min-height: 300px;
            overflow: hidden;
            border-radius: 8px;
            container-type: inline-size;
            contain: content;
            background-color: #000600;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .slider_content {
            flex-grow: 1;
            display: flex;
            justify-content: space-between;
            position: relative; /* Ensure arrows sit on top */
            z-index: 2;
        }

        .image-display {
            /* Changed from fixed to absolute so it stays inside the box */
            position: absolute; 
            inset: 0;
            width: 100%;
            height: 100%;
            z-index: -1; /* Behind arrows */
        }
        
        .image-display img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* --- Controls (Arrows) --- */
        .slider-control--button {
            border: 0;
            background: 0;
            outline: 0;
            cursor: pointer;
            place-content: center;
            padding-inline: 20px;
            z-index: 5;
            display: grid;
            transition: background 0.3s;
        }

        .fa {
            font-size: 2.5rem;
            color: #bcc0c2;
            transition: color 0.3s;
        }

        .slider-control--button:hover {
            background-image: linear-gradient(to var(--position), #0000 0%, #0002, #0006 100%);
        }
        
        .slider-control--button:hover .fa { color: #ffffff; }
        .prev-button { --position: left; }
        .next-button { --position: right; }


        /* --- Navigation (Thumbnails) --- */
        .slider-navigation {
            z-index: 10;
            display: grid;
            grid-auto-flow: column;
            /* Adjusted grid to auto-fit available thumbnails */
            grid-template-columns: repeat(auto-fit, minmax(1fr, 1fr)); 
            gap: 10px;
            padding: 10px;
            background-color: rgba(225, 227, 229, 0.8); /* Semi-transparent */
            backdrop-filter: blur(6px);
        }

        .nav-button {
            display: block;
            width: 100%;
            border-radius: 0.5rem;
            overflow: hidden;
            border: 0;
            aspect-ratio: 16/9;
            transition: transform 0.2s ease, filter 0.2s;
            cursor: pointer;
            padding: 0;
        }

        .thumbnail {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        .nav-button[aria-selected="true"] {
            transform: scale(1.1);
            outline: 3px solid #0f9fff;
            z-index: 2;
        }

        .nav-button[aria-selected="false"] { filter: opacity(0.6); }
        .nav-button[aria-selected="false"]:hover { filter: opacity(1); }


        /* --- 2. NEW ANIMATION STYLES --- */
        
        /* Image Fade In */
        .animate-fade {
            animation: fadeIn 0.8s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(1.05); }
            to { opacity: 1; transform: scale(1); }
        }

        /* Text Transition */
        .facility-details h2, 
        .facility-details p {
            transition: opacity 0.4s ease-in-out;
        }
        
        /* Class added via JS to hide text briefly */
        .text-fade-out {
            opacity: 0;
        }

        .facility-details h2 { margin-top: 0; color: #333; font-size: 2rem;}
        .facility-details p { line-height: 1.6; color: #666; }

    </style>
</head>
<body>

    <section class="facility">
        
        <div class="image-slider">
            <section class="slider_content">
                <button class="slider-control--button prev-button">
                    <i class="fa fa-arrow-circle-left"></i>
                </button>
                
                <main class="image-display"></main>
                
                <button class="slider-control--button next-button">
                    <i class="fa fa-arrow-circle-right"></i>
                </button>
            </section>
            
            <nav class="slider-navigation">
                <button class="nav-button" aria-selected="true" 
                    data-title="Hydora Park (Block E)" 
                    data-desc="Experience the serenity of nature at Hydora Park, featuring lush greenery, calming water features, and spaces designed for relaxation.">
                    <img src="templates/images/1) Hydora Park (Block E).png" alt="Hydora Park" class="thumbnail">
                </button>

                <button class="nav-button" aria-selected="false" 
                    data-title="Central Walk" 
                    data-desc="The Central Walk connects all major hubs with a vibrant, pedestrian-friendly pathway lined with retail shops and cafes.">
                    <img src="templates/images/2) Central walk .png" alt="Central Walk" class="thumbnail">
                </button>

                <button class="nav-button" aria-selected="false" 
                    data-title="Victoria Park" 
                    data-desc="Victoria Park offers a classic landscape design with beautiful lighting, perfect for evening strolls and community gatherings.">
                    <img src="templates/images/3) Victoria Park (BlkD).jpg .png" alt="Victoria Park" class="thumbnail">
                </button>

                <button class="nav-button" aria-selected="false" 
                    data-title="Landscape Perspective" 
                    data-desc="Our landscape architecture focuses on sustainability and aesthetics, providing a modern green environment for all residents.">
                    <img src="templates/images/4) Landscape Perspective 4.jpg" alt="Landscape" class="thumbnail">
                </button>

                <button class="nav-button" aria-selected="false" 
                    data-title="Children's Playground" 
                    data-desc="A safe and fun environment for children to play, equipped with modern play structures and safety flooring.">
                    <img src="templates/images/5) Children Playground.jpg" alt="Playground" class="thumbnail">
                </button>

            </nav>
        </div>

        <div class="facility-details">
            <h2 id="facility-title">Facilities</h2>
            <p id="facility-desc">Loading facility details...</p>
        </div>

    </section>

    <script>
        class Slider {
            constructor(slider) {
                this.slider = slider;
                this.display = slider.querySelector('.image-display');
                this.navButton = Array.from(slider.querySelectorAll('.nav-button'));
                this.prevButton = slider.querySelector('.prev-button');
                this.nextButton = slider.querySelector('.next-button');
                this.sliderNavigation = slider.querySelector('.slider-navigation');

                // Get the Facility Text elements (Next to the slider)
                this.detailsContainer = slider.closest('.facility').querySelector('.facility-details');
                this.titleElement = this.detailsContainer.querySelector('#facility-title');
                this.descElement = this.detailsContainer.querySelector('#facility-desc');

                this.currentIndex = 0;
                this.preloadedImages = {};
                
                // AUTOMATION CONFIG
                this.autoPlayInterval = null;
                this.autoPlayDelay = 4000; // Change slide every 4 seconds

                this.initialize();
            }

            initialize() {
                this.preloadImages();
                this.setupSlider();
                this.eventListeners();
                this.startAutoPlay(); // Start automation
            }

            setupSlider() {
                this.showSliderImage(this.currentIndex);
            }

            showSliderImage(index) {
                this.currentIndex = index;

                // 1. Update Image
                const navButtonImg = this.navButton[this.currentIndex].querySelector('img');
                if (navButtonImg) {
                    const imgClone = navButtonImg.cloneNode(true);
                    
                    // Add fade animation class
                    imgClone.classList.add('animate-fade');
                    
                    this.display.replaceChildren(imgClone);

                    // Remove animation class after it finishes
                    setTimeout(() => {
                        imgClone.classList.remove('animate-fade');
                    }, 800);
                }

                // 2. Update Text
                this.updateTextContent(index);

                // 3. Update Nav Buttons
                this.updateNavButtons();
            }

            updateTextContent(index) {
                const button = this.navButton[index];
                const newTitle = button.getAttribute('data-title');
                const newDesc = button.getAttribute('data-desc');

                // Add fade-out class to text container
                this.detailsContainer.classList.add('text-fade-out');

                // Wait 400ms (halfway through transition), swap text, then fade in
                setTimeout(() => {
                    if (this.titleElement) this.titleElement.textContent = newTitle || "Facility";
                    if (this.descElement) this.descElement.textContent = newDesc || "";
                    
                    this.detailsContainer.classList.remove('text-fade-out');
                }, 400);
            }

            updateNavButtons() {
                this.navButton.forEach((button, buttonIndex) => {
                    const isSelected = buttonIndex === this.currentIndex;
                    button.setAttribute('aria-selected', isSelected);
                });
            }

            preloadImages() {
                this.navButton.forEach(button => {
                    const img = button.querySelector('img');
                    if (img && img.src && !this.preloadedImages[img.src]) {
                        this.preloadedImages[img.src] = new Image();
                        this.preloadedImages[img.src].src = img.src;
                    }
                });
            }

            /* --- AUTOMATION LOGIC --- */
            startAutoPlay() {
                this.stopAutoPlay();
                this.autoPlayInterval = setInterval(() => {
                    this.handleAction('next');
                }, this.autoPlayDelay);
            }

            stopAutoPlay() {
                if (this.autoPlayInterval) clearInterval(this.autoPlayInterval);
            }

            resetAutoPlay() {
                this.stopAutoPlay();
                this.startAutoPlay();
            }

            eventListeners() {
                // Keyboard
                document.addEventListener('keydown', (e) => {
                    this.resetAutoPlay();
                    this.handleAction(e.key);
                });

                // Thumbnail Click
                this.sliderNavigation.addEventListener('click', (e) => {
                    const targetButton = e.target.closest('.nav-button');
                    const index = targetButton ? this.navButton.indexOf(targetButton) : -1;
                    if (index !== -1) {
                        this.resetAutoPlay();
                        this.showSliderImage(index);
                    }
                });

                // Arrow Clicks
                this.prevButton.addEventListener('click', () => {
                    this.resetAutoPlay();
                    this.handleAction('prev');
                });
                this.nextButton.addEventListener('click', () => {
                    this.resetAutoPlay();
                    this.handleAction('next');
                });

                // Pause on Hover
                this.slider.addEventListener('mouseenter', () => this.stopAutoPlay());
                this.slider.addEventListener('mouseleave', () => this.startAutoPlay());
            }

            handleAction(action) {
                if (action === 'Home') this.currentIndex = 0;
                else if (action === 'End') this.currentIndex = this.navButton.length - 1;
                else if (action === 'ArrowRight' || action === 'next') {
                    this.currentIndex = (this.currentIndex + 1) % this.navButton.length;
                } else if (action === 'ArrowLeft' || action === 'prev') {
                    this.currentIndex = (this.currentIndex - 1 + this.navButton.length) % this.navButton.length;
                }
                this.showSliderImage(this.currentIndex);
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            const sliderElement = document.querySelector('.image-slider');
            if (sliderElement) {
                new Slider(sliderElement);
            }
        });
    </script>
</body>
</html>